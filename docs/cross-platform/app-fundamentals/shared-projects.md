---
title: Использование общих проектов для совместного использования кода
description: Общие проекты позволяют писать общий код, на который ссылается несколько проектов различных приложений. Код компилируется как часть каждого ссылающийся проект и могут включать директивы компилятора, помогающие внедрить функциональность платформы в общий кодовой базы.
ms.prod: xamarin
ms.assetid: 191c71fb-44a4-4e6c-af4b-7b1107dce6af
author: conceptdev
ms.author: crdun
ms.date: 07/18/2018
ms.openlocfilehash: 61096635cd94d0fdd0abe6fda59c4efa41eeceb1
ms.sourcegitcommit: 46bb04016d3c35d91ff434b38474e0cb8197961b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/26/2018
ms.locfileid: "39270219"
---
# <a name="shared-projects-code-sharing"></a>Общие проекты совместного использования кода

_Общие проекты позволяют писать общий код, на который ссылается несколько проектов различных приложений. Код компилируется как часть каждого ссылающийся проект и могут включать директивы компилятора, помогающие внедрить функциональность платформы в общий кодовой базы._

Общие проекты (которые иногда называют общих проектов активов) позволяют писать код, который разделяется между несколькими проектами целевой, включая приложения Xamarin.

Они поддерживают директивы компилятора, таким образом, можно условно включал код конкретной платформы, которую следует скомпилировать в подмножество проектов, ссылающихся на общий проект. Кроме того, поддерживается интегрированной среды разработки для управления директивах компилятора и визуализации, как код будет выглядеть в каждом приложении.

Если вы использовали файл связывания в прошлом для совместного использования кода между проектами, проектах общих работает аналогичным образом, но со значительно улучшенную поддержку интегрированной среды разработки.

## <a name="what-is-a-shared-project"></a>Что такое общий проект?

В отличие от большинства других типов проектов общий проект не имеет никаких выходных данных (в виде библиотеки DLL), вместо этого код компилируется в каждый проект, который ссылается на нее. Это показано на схеме ниже — по существу все содержимое общедоступного проекта «скопирован в» каждого ссылающийся проект и компилируется так, будто она входила в состав их.

![](shared-projects-images/sharedassetproject.png "Общей архитектуре проекта")

Код в общий проект может содержать директивы компилятора, которые будут включить или отключить фрагменты кода, в зависимости от того, какое приложение в проекте используется код, который предлагается в окнах цветной платформы, на схеме.

Сам по себе не компилируется общего проекта, если проект существует только как группа файлов исходного кода, которые могут быть включены в других проектах. Когда ссылка на другой проект, как эффективно компилировать код *часть* этого проекта. Общие проекты не могут ссылаться на другие типы проектов (в том числе и в других проектах общих).

Обратите внимание, что проектах приложений Android не может ссылаться на другие проекты приложения Android — например, проект Android модульного теста не может ссылаться на проект приложения Android. Дополнительные сведения об ограничениях см. в этом [обсуждения в форумах](http://forums.xamarin.com/discussion/comment/98092/).

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

## <a name="visual-studio-for-mac-walkthrough"></a>Пошаговое руководство по Visual Studio для Mac

В этом разделе описано, как создать и использовать общий проект, с помощью Visual Studio для Mac. См. в [общий пример проекта](#Shared_Project_Example) разделе полный пример.

## <a name="creating-a-shared-project"></a>Создание общего проекта

Чтобы создать новый общий проект перейдите к **файл > новое решение...**  (или щелкните правой кнопкой мыши существующее решение и выбрав **Добавить > Добавить новый проект...** ):

[![Новый общий проект](shared-projects-images/xs-newsolution-sml.png "новое решение")](shared-projects-images/xs-newsolution.png#lightbox)

На следующем экране выберите имя проекта и нажмите кнопку **создать**.

Ниже приведен общий проект — Обратите внимание, что это не ссылки или узлы компонентов; они не поддерживаются для общих проектов.

![Пустой общий проект](shared-projects-images/xs-empty.png "пустой общий проект")

Для общего проекта будут полезны ему необходимо ссылаться хотя бы один проект можно использовать сборки (например, iOS или Android приложения или библиотеки или проекта переносимой библиотеки Классов). Общий проект не компилируется, когда он ничего не ссылается на его, поэтому синтаксис (или любой другой) ошибки не будут выделены, пока он ссылается, что-то еще.

Добавить ссылку на общий проект выполняется так же, как ссылки на обычный проект библиотеки. На этом снимке экрана показан проект Xamarin.iOS, ссылающихся на общий проект.

![](shared-projects-images/xs-reference.png "Ссылка проекта на общий проект")

После общий проект ссылается другой библиотеки или приложение можно построить решение и просмотреть ошибки в коде. Если ссылка на общий проект с _двух или более_ других проектах, появится меню в левой верхней части редактора исходного кода, показано выбрать, какие проекты ссылку на него.

## <a name="shared-project-options"></a>Общие параметры проекта

Когда щелкните правой кнопкой мыши на общий проект и выберите **параметры** существует меньше параметров, чем другие типы проектов. Так как в проектах общих не компилируются (сами по себе), нельзя задать параметры вывода или компилятора, конфигурации проекта, подпись сборки или пользовательские команды. Код в общий проект фактически наследует эти значения все, что является ссылка на него.



**Параметры** экрана показан ниже - проект **имя** и **пространство имен по умолчанию** являются только двумя параметрами, которые обычно будут изменены.


![](shared-projects-images/xs-sharedprojectoptions.png "Общие параметры проекта")



# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)



## <a name="visual-studio-walkthrough"></a>Пошаговое руководство по Visual Studio


В этом разделе описано, как создать и использовать общий проект, с помощью Visual Studio. Обратитесь к [общий пример проекта](#Shared_Project_Example) разделе полную реализацию.

### <a name="creating-a-shared-project"></a>Создание общего проекта

Чтобы создать новый общий проект перейдите к **файл > новое решение...**  и выберите имя для проекта и решения.

![](shared-projects-images/vs-newsolution.png "Создание решения")

Можно также добавить новый общий проект в решение, щелкнув файл решения и выбрав **Добавить > Новый проект...** . Новый общий проект выглядит так, как показано ниже (после добавления файла класса) — Обратите внимание, что нет ссылок или узлы компонентов; они не поддерживаются для общих проектов.

![](shared-projects-images/vs-empty.png "Пустой общего проекта")

Для общего проекта будут полезны ему необходимо ссылаться хотя бы один проект можно использовать сборки (например, iOS или Android приложения или библиотеки или проекта переносимой библиотеки Классов). Общий проект не компилируется, когда он ничего не ссылается на его, поэтому синтаксис (или любой другой) ошибки не будут выделены, пока он ссылается, что-то еще.

Добавить ссылку на общий проект выполняется так же, как ссылки на обычный проект библиотеки. На этом снимке экрана показан проект Xamarin.iOS, ссылающихся на общий проект.

![](shared-projects-images/vs-reference.png "Ссылка проекта на общий проект")

После общий проект ссылается другой библиотеки или приложение можно построить решение и просмотреть ошибки в коде. Если ссылка на общий проект с _двух или более_ появится меню с другими проектами, в левой верхней части редактора исходного кода, чтобы увидеть, какие проекты ссылки текущего файла кода.


### <a name="shared-project-properties"></a>Общедоступные свойства проекта


При выборе общего проекта существует меньше параметров на панели свойств, чем другие типы проектов. Так как в проектах общих не компилируются (сами по себе), нельзя задать параметры вывода или компилятора, конфигурации проекта, подпись сборки или пользовательские команды. Код в общий проект фактически наследует эти значения все, что является ссылка на него.

**Свойства** панели отображается ниже - **корневое пространство имен** — единственный параметр, который можно изменить.

![](shared-projects-images/vs-sharedprojectproperties.png "Общедоступные свойства проекта")

-----

<a name="Shared_Project_Example"/>

## <a name="shared-project-example"></a>Пример общего проекта

[Tasky](https://github.com/xamarin/mobile-samples/tree/master/Tasky) пример использует общий проект, содержащий общий код, используемом средой оба iOS, Android и Windows Phone приложениями. Как `SQLite.cs` и `TaskRepository.cs` файлы исходного кода использование директивы компилятора (например) `#if __ANDROID__`) для получения разных выходных данных для каждого из приложений, которые на них ссылаются.

Полное решение структура приведена ниже (в Visual Studio для Mac и Visual Studio соответственно):

# <a name="visual-studio-for-mactabmacos"></a>[Visual Studio для Mac](#tab/macos)

![](shared-projects-images/xs-examplesolution.png "Visual Studio для Mac решение")

# <a name="visual-studiotabwindows"></a>[Visual Studio](#tab/windows)

![](shared-projects-images/vs-examplesolution.png "Решение Visual Studio")

-----

Проект Windows Phone можно переходить из среды Visual Studio для Mac, несмотря на то, что данный тип проекта не поддерживается для компиляции в Visual Studio для Mac.

Запущенные приложения, показаны ниже:

![](shared-projects-images/example.png "iOS, Android, Windows Phone, примеры")

## <a name="summary"></a>Сводка

В этом документе описано, как работают общие проекты, как они могут быть создаются и используются в Visual Studio для Mac и Visual Studio и появился простой пример приложения, демонстрирующий общего проекта в действии.

## <a name="related-links"></a>Связанные ссылки

- [Tasky примера приложения](https://github.com/xamarin/mobile-samples/tree/master/Tasky)
- [Переносимые библиотеки классов (пример)](~/cross-platform/app-fundamentals/pcl.md)
- [Варианты совместного использования кода (пример)](~/cross-platform/app-fundamentals/code-sharing.md)
