---
title: Динамическая перезагрузка
description: Увидеть изменения в XAML в режиме реального времени, не требуя другой компиляции и развертывания.
ms.prod: xamarin
ms.assetid: 4917273d-32f9-401a-a52c-5cfb53a2170d
ms.technology: xamarin-forms
author: pierceboggan
ms.author: piboggan
ms.date: 05/11/2018
ms.openlocfilehash: 12b677c8cc4a709a865d2eaee3ea44a6babf1b05
ms.sourcegitcommit: 632955f8cdb80712abd8dcc30e046cb9c435b922
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2018
ms.locfileid: "38860671"
---
# <a name="xamarin-live-reload"></a>Xamarin динамической перезагрузки

![Предварительный просмотр](~/media/shared/preview.png)

Xamarin Live Reload позволяет **вносить изменения в XAML и они отразятся в режиме реального времени, без необходимости другую компиляции и развертывания**. Изменения, внесенные в XAML будет повторно развернуто на сохранение и отражаются на целевой развертывание.

Поскольку приложение компилируется при использовании Live перезагрузить, он работает с все библиотеки и сторонние элементы управления. Динамическая перезагрузка работает на всех платформах Xamarin.Forms поддерживает, включая Android, iOS и универсальной платформы Windows и работает на всех стадиях допустимым развертывания, включая симуляторов, эмуляторах и физические устройства.

> [!Video https://www.youtube.com/embed/-5WJZpeXlC8]

Динамической перезагрузки в данный момент доступна только в Visual Studio 2017.

## <a name="requirements"></a>Требования

* [Visual Studio 2017 версии 15.7 или более поздней версии](https://visualstudio.microsoft.com/vs/) или более поздней версии с **разработки мобильных приложений на .NET** рабочей нагрузки.
* [Xamarin.Forms 3.0.0 или более поздней версии](https://www.nuget.org/packages/Xamarin.Forms/) или более поздней версии.

## <a name="getting-started"></a>Начало работы
### <a name="1-install-xamarin-live-reload-from-the-visual-studio-marketplace"></a>1. Установка динамической перезагрузки Xamarin в Visual Studio Marketplace

Xamarin Live перезагрузить распространяется через Visual Studio Marketplace. Чтобы установить расширение, посетите [Xamarin Live перезагрузить страницу, в Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=Xamarin.XamarinLiveReload) веб-сайта и нажмите кнопку **загрузить**.

Откройте .vsix, который загружается и нажмите кнопку **установить**.

![Установщик Visual Studio Xamarin Live перезагрузить подтверждения](images/LiveReloadVSIXInstall.png)

Кроме того, вы можете найти его в **Online** вкладке **расширения и обновления** диалоговое окно в Visual Studio.

### <a name="2-configure-your-app-to-use-live-reload"></a>2. Настройка приложения для использования динамической перезагрузки

Добавление Live перезагрузить для существующих мобильных приложений может выполняться в три этапа:

1. Обновить все проекты для использования [Xamarin.Forms 3.0.0 или более поздней версии](https://www.nuget.org/packages/Xamarin.Forms/) или более поздней версии.

2. Добавить **Xamarin.LiveReload** пакет NuGet:

    1. **.NET standard** — установить **Xamarin.LiveReload** NuGet в библиотеку .NET Standard 2.0. Это не обязательно должен быть установлен в проектах платформы. Убедитесь, что **источник пакета** присваивается **все**.
    
    2. **Общие проекты** — установить **Xamarin.LiveReload** NuGet в проекты для всех платформ (таких как Android, iOS, универсальной платформы Windows, и т.д.). Убедитесь, что **источник пакета** присваивается **все**.

    [![Добавить пакет NuGet динамической перезагрузки Xamarin с помощью диспетчера пакетов NuGet](images/addlivereloadnuget.w157-sml.png)](images/addlivereloadnuget.w157.png#lightbox)

3. Добавить `LiveReload.Init();` в конструктор в `Application` класса, как показано в следующем фрагменте кода:

```csharp
public partial class App : Application
{
    public App ()
    {
        // Initialize Live Reload.
        #if DEBUG
        LiveReload.Init();
        #endif
        
        InitializeComponent();
        MainPage = new MainPage();
    }
}
```

### <a name="3-start-live-reloading"></a>3. Запуск динамической перезагрузки

Скомпилируйте и разверните приложение. После приложение будет развернуто, откройте файл XAML, внести некоторые изменения и сохраните файл. Изменения производится повторное развертывание на целевом объекте развертывания.

> [!Video https://www.youtube.com/embed/-5WJZpeXlC8]

Перезагрузить работает с изменениями в любой файл XAML в реальном времени. Изменения в C# или добавления и удаления пакетов NuGet требуется новое построение и развертывание вступили в силу.

## <a name="frequently-asked-questions"></a>Вопросы и ответы 
### <a name="is-xamarin-live-reload-available-on-visual-studio-for-mac"></a>Доступен Xamarin Live перезагрузить Visual Studio для Mac? 

Начальная Предварительная версия Xamarin Live перезагрузки доступна только для Visual Studio 2017. Поддержка Visual Studio для Mac планируется в будущих выпусках.

### <a name="does-this-work-with-all-libraries-such-as-prism"></a>Это работает с всех библиотек, таких как Prism? 

Так как ваше приложение скомпилировано, Live перезагрузить работает с всех библиотек, таких как Prism и библиотеками сторонних элементов управления, такие как Telerik, Infragistics, Syncfusion, ArcGIS, GrapeCity и других поставщиков управления.

### <a name="what-changes-does-live-reload-redeploy"></a>Какие изменения Live перезагрузить повторного развертывания? 

Динамической перезагрузки применяется только изменения, внесенные в XAML или CSS. При внесении изменений в файл C#, потребуется повторную компиляцию. В будущих выпусках планируется поддержка для перезагрузки C#.

### <a name="what-platforms-are-supported"></a>Какие платформы поддерживаются? 

Динамической перезагрузки работает на любой платформе, поддерживаемых Xamarin.Forms, включая Android, iOS и универсальной платформы Windows.

### <a name="does-this-work-on-emulators-simulators-and-physical-devices"></a>Это работает на эмуляторах, физических устройствах и эмуляторах? 

Да, перезагрузить Live работает со всеми целевыми объектами допустимого развертывания, включая эмуляторов Android, iOS симуляторов и физические устройства. Развертывание на устройстве требуется устройство и компьютер в одной сети Wi-Fi.

### <a name="does-this-work-with-corporate-networks"></a>Это работает с корпоративным сетям?

Если отладка выполняется в эмуляторе Android или iOS simulator, Live перезагрузить используется имя localhost для обмена данными. Если вы хотите развернуть на устройство, устройство и компьютер должны быть в той же сети Wi-Fi. В сценариях, где это невозможно, вы можете [настроить собственный сервер Live перезагрузить](#live-reload-server), который позволит вам Live перезагрузить, независимо от того, параметры подключения к сети.

### <a name="does-it-require-debugging-the-app"></a>Требуется отладка приложения? 

Нет. На самом деле можно запустить все поддерживаемые приложение предназначено (Android, iOS и UWP) на любом количестве устройств и симуляторов/эмуляторов и просмотреть их все обновления за один раз. 

## <a name="limitations"></a>Ограничения

* Поддерживается только необходимость принудительной повторной загрузки XAML.
* Состояние пользовательского интерфейса может не поддерживаться между повторно развертывает, если только с помощью MVVM.

## <a name="known-issues"></a>Известные проблемы

* Поддерживается только в Visual Studio.
* Связывание должно быть присвоено **не компоновать** или **ссылку только пакеты SDK** 
* Повторная загрузка ресурсы на уровне приложения (т. е. **App.xaml** или Общие словари ресурсов), приложение навигации сбрасывается. Это будет исправлено в следующем выпуске предварительной версии.
* Редактирование XAML во время отладки UWP может вызвать сбой во время выполнения. Решение: Используйте **Запуск без отладки (Ctrl + F5)** вместо **начать отладку (F5)**.

## <a name="troubleshooting"></a>Устранение неполадок

### <a name="error-codes"></a>Коды ошибок

* **XLR001**: *текущий проект ссылается на версию пакета NuGet «Xamarin.LiveReload» «[VERSION]», но расширение Xamarin Live перезагрузка требуется версия «[VERSION]».*

  Чтобы разрешить Быстрая итерация и Эволюция функцию Live перезагрузить, пакет nuget и расширения Visual Studio должны точно совпадать. Обновите свой пакет nuget до той же версии установленного расширения.

* **XLR002**: *перезагрузить Live требуется по крайней мере свойство «MqttHostname» при построении из командной строки. Можно также задать «EnableLiveReload» значение «false», чтобы отключить эту функцию.*

  Свойства, необходимые Live перезагрузить будут недоступны при построении из командной строки (или в непрерывной интеграции) и поэтому должен быть предоставлен явно. 

* **XLR003**: *пакет nuget Live перезагрузить требует установки расширения Xamarin Live перезагрузить Visual Studio.*

  Попытка построить проект, ссылающийся на пакет nuget Live перезагрузки, но Visual расширение не установлено.  

* *Возникло исключение при загрузке сборки: System.IO.FileNotFoundException: не удалось загрузить сборку "Xamarin.Live.Reload, Version = 0.3.27.0, язык и региональные параметры = neutral, PublicKeyToken =".*

  Базовый проект следует использовать `PackageReference` вместо `packages.config`

### <a name="app-doesnt-connect"></a>Приложение не сможет подключиться.

При построении приложения информацию из **средства > Параметры > Xamarin > Live перезагрузить** (имени узла, порта и шифрования ключей) внедряются в приложении, так что при `LiveReload.Init()` выполняется связывание или конфигурации — необходимые для подключения для успешного выполнения.

Кроме обычных сетевых неполадок (брандмауэр, устройство в другой сети) основной причиной, что приложение не может успешно подключаться интегрированной среды разработки обусловлено конфигурации отличается от того, в Visual Studio. Это может произойти, если:

* Приложение было скомпилировано на другом компьютере.
* Приложения была скомпилирована и развернута в другом сеансе Visual Studio, и **автоматически создавать ключи шифрования** — флажок установлен (по умолчанию) **Сервис > Параметры > Xamarin > Live перезагрузить**.
* Параметры Visual Studio были изменены (т. е. имя узла, порта или шифрования ключей), но приложение не был разработан и развернуть повторно.

Эти случаи решаются путем создания и повторно развертывать приложение.

### <a name="uninstalling-preview-1"></a>Удаление предварительной версии 1

Если у вас есть более старые предварительной версии, и у вас есть проблемы с удалением его, выполните следующие действия.

1. Удалите папку **\Microsoft Visual Studio\Preview\Enterprise\Common7\IDE\Extensions\Xamarin\LiveReload C:\Program Files (x86)** (Примечание: Замените на установленный выпуск «Корпоративный» и «Preview» с «2017» Если вы установлена в стабильной Visual STUDIO)
2. Откройте **Командная строка разработчика** для этого Visual Studio и запустите `devenv /updateconfiguration`. 

## <a name="tips--tricks"></a>Советы и рекомендации

* До тех пор, пока не измените параметры перезагрузки Live (включая ключи шифрования, например, если вы будете отключать **автоматически создавать ключи шифрования**) и сборки с помощью одного компьютера, не требуется для создания и развертывания приложения после первоначального развертывание, если не изменить код или зависимости. Можно просто запустить снова ранее развернутое приложение, и он будет подключаться к последнему хоста, используемого.

* Нет ограничений на количество устройств, можно подключиться к тому же сеансу Visual Studio. Можно развернуть и запустить приложение в любое количество устройств и симуляторов, при необходимости см. в реальном времени перезагрузка работа на каждом из них в то же время.

* Динамической перезагрузки перезагрузит только части интерфейса пользователя приложения, но *не* повторно создавать страницы, ни его замены модели представления (или контекст привязки). Это означает, что *всей* состояние приложения всегда сохраняется, перезагрузках, включая внедренного зависимостей.

## <a name="live-reload-server"></a>Динамической перезагрузки сервера

В сценариях там, где подключение к вашей машины из запущенного приложения (обозначенное с помощью `localhost` или `127.0.0.1` в **Сервис > Параметры > Xamarin > Live перезагрузить**) не поддерживается (т. е. брандмауэры, разных сетях), можно настроить удаленный сервер вместо этого которой интегрированной среды разработки и приложение будет подключиться к.

Динамической перезагрузки использует стандарт [протокола MQTT](http://mqtt.org/) для обмена сообщениями и поэтому может взаимодействовать с [сторонние серверы](https://github.com/mqtt/mqtt.github.io/wiki/servers). Имеются даже [общедоступные серверы](https://github.com/mqtt/mqtt.github.io/wiki/public_brokers) (также известный как *брокеров*), можно использовать. Динамической перезагрузки был протестирован с `broker.hivemq.com` и `iot.eclipse.org` имена узлов, а также службы, предоставляемые [www.cloudmqtt.com](https://www.cloudmqtt.com) и [www.cloudamqp.com](https://www.cloudamqp.com). Вы также можете развернуть собственный сервер MQTT в облаке, такие как [HiveMQ в Azure](https://www.hivemq.com/blog/hivemq-on-windows-azure-mqtt-microsoft-cloud).

Можно настроить любой порт, но это обычно используется порт 1883 по умолчанию для удаленных серверов. Динамическая перезагрузка сообщения используют надежный end-to-end симметричного шифрования AES, поэтому можно безопасно подключаться к удаленным серверам. По умолчанию этот ключ и вектор инициализации (IV) создаются повторно в каждом сеансе Visual Studio.

Возможно, самым простым способом является установка [mosquitto](https://mosquitto.org) сервера в пустой виртуальной Машины Ubuntu в Azure:

1. Создайте виртуальную Машину Ubuntu Server на портале Azure
2. Добавить новое правило входящий порт для 1883 (порт по умолчанию MQTT) на вкладку "Сеть"
3. Откройте [Cloud Shell](https://docs.microsoft.com/azure/cloud-shell/overview) (bash режим)
4. Введите `ssh [USERNAME]@[PUBLIC_IP]` с помощью имени пользователя, выбранное на 1) и общедоступный IP-адрес, показанный на вашей странице обзора виртуальной Машины
5. Запустите `sudo apt-get install mosquitto`, ввода пароля, выбранное на 1)

Теперь можно использовать этот IP-адрес для подключения к серверу MQTT.
