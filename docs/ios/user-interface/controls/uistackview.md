---
title: Стек представлений в Xamarin.iOS
description: Этой статье описывается использование нового элемента управления UIStackView приложения Xamarin.iOS для управления набором вложенных представлений, либо горизонтально или вертикально упорядоченный стек.
ms.prod: xamarin
ms.assetid: 20246E87-2A49-438A-9BD7-756A1B50A617
ms.technology: xamarin-ios
ms.custom: xamu-video
author: lobrien
ms.author: laobri
ms.date: 03/20/2017
ms.openlocfilehash: d04ce6827f6695163c7d9a8d34acc3891d854c8d
ms.sourcegitcommit: e268fd44422d0bbc7c944a678e2cc633a0493122
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2018
ms.locfileid: "50122677"
---
# <a name="stack-views-in-xamarinios"></a>Стек представлений в Xamarin.iOS

_Этой статье описывается использование нового элемента управления UIStackView приложения Xamarin.iOS для управления набором вложенных представлений, либо горизонтально или вертикально упорядоченный стек._

> [!IMPORTANT]
> Обратите внимание на то, что хотя StackView поддерживается в конструкторе iOS, могут возникнуть ошибки удобства использования при использовании стабильный канал. При переключении каналов альфа или бета-версиях должно устранить эту проблему. Мы решили представить в этом пошаговом руководстве, с помощью Xcode до исправления, необходимые реализуются в стабильном канале.

Элемент управления представление стека (`UIStackView`) использует возможности автоматического макета и размеры для управления стек представлений, горизонтально или вертикально, динамически соответствующая значениям, ориентации и размера экрана устройства iOS.

В зависимости от разработчика определенные свойства, такие как оси, распространение, выравнивание и интервал управляются макет всех вложенных представлений, прикреплено к представлению стека:

[![](uistackview-images/stacked01.png "Схема макета представления стека")](uistackview-images/stacked01.png#lightbox)

При использовании `UIStackView` приложения Xamarin.iOS, разработчик может определить либо вложенных представлений, либо внутри раскадровки в конструкторе iOS, или путем добавления и удаления представлений в коде C#.

Этот документ состоит из двух частей: быстрого запуска, которые помогут реализовать просмотр первого стеке, а затем некоторые дополнительные технические сведения о принципах.

> [!VIDEO https://youtube.com/embed/p3po6507Ip8]

**UIStackView, по [Xamarin University](https://university.xamarin.com/)**

## <a name="uistackview-quickstart"></a>Краткое руководство UIStackView

Как краткие сведения о `UIStackView` элемента управления, мы собираемся создать простой интерфейс, который позволяет пользователю ввести оценку от 1 до 5. Мы будем использовать два представления стека: один для упорядочивания интерфейс вертикально пальцем экрана и один для упорядочения значков оценка 1 – 5 по горизонтали по экрану.

### <a name="define-the-ui"></a>Определения пользовательского интерфейса

Создание нового проекта Xamarin.iOS и изменить **Main.storyboard** файл конструктора Interface Builder. Во-первых, перетащите один **вертикальное представление стека** на **контроллер представления**:

[![](uistackview-images/quick01.png "Перетащите одно вертикальное представление стека в контроллере представления")](uistackview-images/quick01.png#lightbox)

В **инспекторе атрибутов**, задать следующие параметры:

[![](uistackview-images/quick02.png "Задание параметров представление стека")](uistackview-images/quick02.png#lightbox)

Где:

- **Оси** — определяет, если представление стека упорядочивает вложенные представления либо **горизонтально** или **вертикально**.
- **Выравнивание** — управляет выравниванием вложенные представления в виде стека.
- **Распределение** — определяет способ изменения размеров вложенные представления в виде стека.
- **Интервал между** — определяет минимальное расстояние между каждой вложенное представление в представление стека.
- **Относительно базовых показателей** — Если этот флажок установлен, вертикальный интервал каждого вложенное представление будет получен из его базовых показателей.
- **Макет поля относительный** — помещает вложенные представления относительно полей стандартным макетом.

При работе с представление стека, можно представить себе **выравнивание** как **X** и **Y** расположение вложенное представление и **распространения** как **Высота** и **ширины**.

> [!IMPORTANT]
> `UIStackView` разработан как представление не визуализируемых контейнера и таким образом, для ее правильной ориентации на холст, как и другие подклассы `UIView`. Поэтому задание свойства, такие как `BackgroundColor` или переопределение `DrawRect` не будет действовать visual.

Перейдите к макета интерфейс приложения, добавив метку, ImageView, две кнопки и горизонтальное представление стека, как показано ниже:

[![](uistackview-images/quick03.png "Размещение пользовательского интерфейса представление стека")](uistackview-images/quick03.png#lightbox)

Настройте горизонтальное представление стека со следующими параметрами:

[![](uistackview-images/quick04.png "Настройте параметры горизонтальной представление стека")](uistackview-images/quick04.png#lightbox)

Так как мы не станем значок, который представляет каждый «point» в рейтинге быть растянуто при добавлении в горизонтальное представление стека, мы задали **выравнивание** для **Center** и  **Распределение** для **заполнения в равной степени**.

Наконец, подключить следующие **розеток** и **действия**:

[![](uistackview-images/quick05.png "Переменные экземпляров представление стека и действия")](uistackview-images/quick05.png#lightbox)

### <a name="populate-a-uistackview-from-code"></a>Заполнение UIStackView из кода

Вернитесь в Visual Studio для Mac и редактирования **ViewController.cs** файл и добавьте следующий код:

```csharp
public int Rating { get; set;} = 0;
...

partial void IncreaseRating (Foundation.NSObject sender) {

    // Maximum of 5 "stars"
    if (++Rating > 5 ) {
        // Abort
        Rating = 5;
        return;
    }

    // Create new rating icon and add it to stack
    var icon = new UIImageView (new UIImage("icon.png"));
    icon.ContentMode = UIViewContentMode.ScaleAspectFit;
    RatingView.AddArrangedSubview(icon);

    // Animate stack
    UIView.Animate(0.25, ()=>{
        // Adjust stack view
        RatingView.LayoutIfNeeded();
    });

}

partial void DecreaseRating (Foundation.NSObject sender) {

    // Minimum of zero "stars"
    if (--Rating < 0) {
        // Abort
        Rating =0;
        return;
    }

    // Get the last subview added
    var icon = RatingView.ArrangedSubviews[RatingView.ArrangedSubviews.Length-1];

    // Remove from stack and screen
    RatingView.RemoveArrangedSubview(icon);
    icon.RemoveFromSuperview();

    // Animate stack
    UIView.Animate(0.25, ()=>{
        // Adjust stack view
        RatingView.LayoutIfNeeded();
    });
}
```

Давайте взглянем на несколько частей этого кода подробно. Во-первых, мы используем `if` инструкции, чтобы проверить, что существует не более пяти «звезды» или меньше нуля.

Чтобы добавить новый «звезда» сейчас загрузить изображения и задайте его **режиме содержимого** для **помещаются аспект масштабирования**:

```csharp
var icon = new UIImageView (new UIImage("icon.png"));
icon.ContentMode = UIViewContentMode.ScaleAspectFit;
```

Это предотвращает искажено, при добавлении в представление стека значок «звезда».

Далее мы добавим значок "Создать «"типа звезда "»" представление стека коллекцию вложенных представлений:

```csharp
RatingView.AddArrangedSubview(icon);
```

Вы заметите, что мы добавили `UIImageView` для `UIStackView` `ArrangedSubviews` свойства, а не `SubView`. Необходимо добавить любое представление, что нужно добавить представление стека для управления макета `ArrangedSubviews` свойство.

Сначала удалить вложенное представление из представления Stack, мы получаем вложенное представление для удаления:

```csharp
var icon = RatingView.ArrangedSubviews[RatingView.ArrangedSubviews.Length-1];
```

Затем нам нужно удалить его из обоих `ArrangedSubviews` коллекции и представления Super:

```csharp
// Remove from stack and screen
RatingView.RemoveArrangedSubview(icon);
icon.RemoveFromSuperview();
```

Удаление вложенное представление с только что `ArrangedSubviews` коллекции принимает его выход из элемента управления представление стека, но не удаляет ее на экране.

### <a name="testing-the-ui"></a>Тестирование пользовательского интерфейса

Все необходимые элементы пользовательского интерфейса и кода в месте теперь можно запустить и тестирования интерфейса. При отображении пользовательского интерфейса, все элементы в вертикальное представление стека будет размещаться через равные интервалы сверху вниз.

Когда пользователь касается **повысить рейтинг** кнопки на экран (максимум 5) добавляется другой «звезда»:

[![](uistackview-images/intro01.png "Запуск примера приложения")](uistackview-images/intro01.png#lightbox)

«Звезды» будет автоматически по центру и равномерно распределены в горизонтальное представление стека. Когда пользователь касается **Понизить рейтинг** кнопка, «звезда» будет удалена (пока остаются none).

## <a name="stack-view-details"></a>Просмотр сведений о стеке

Теперь, когда у нас есть общее представление о том, что `UIStackView` элемент управления является и как она работает, рассмотрим более глубокое рассмотрение некоторые его функции и сведения.

### <a name="auto-layout-and-size-classes"></a>Автоматический макет и размеры

Как было показано выше, когда вложенное представление добавляется в представление стека в макете полностью управляется, представление стека, с помощью автоматического макета и размеры позиция и размер упорядоченный представления.

Представление стека будет _ПИН-код_ вложенное представление первый и последний в своей коллекции, чтобы **верхней** и **нижней** границы для создания представления по вертикали стека или **слева**и **справа** границы для создания представлений по горизонтали стека. Если задать `LayoutMarginsRelativeArrangement` свойства `true`, а затем представление фиксирует вложенные представления на соответствующие поля, а не в edge.

Представление стека использует вложенное представление `IntrinsicContentSize` свойство при вычислении размера вложенных представлений вдоль определенного `Axis` (за исключением `FillEqually Distribution`). `FillEqually Distribution` Изменяет размер всех вложенных представлений, чтобы они имеют одинаковый размер, таким образом, заполняя представление стека вдоль `Axis`.

За исключением элемента `Fill Alignment`, представление стека использует вложенное представление `IntrinsicContentSize` свойство для вычисления размера представления перпендикулярно заданного `Axis`. Для `Fill Alignment`, все вложенные представления имеют размер, чтобы они полностью заполняли представление стека, перпендикулярно заданного `Axis`.

### <a name="positioning-and-sizing-the-stack-view"></a>Изменение положения и размера представление стека

Хотя представление стека имеет полный контроль над макетом любой вложенное представление (на основе свойств таких как `Axis` и `Distribution`), по-прежнему необходимо разместить представление стека (`UIStackView`) в рамках его родительского представления, с помощью автоматического макета и размеры.

Как правило это означает, по крайней мере две границы представления Stack, чтобы разворачивать и сворачивать, определив тем самым его положение закрепления. Без дополнительных ограничений представление стека будет изменяться автоматически для всех вложенных представлений следующим образом:

 - Размер вдоль ее `Axis` будет суммой всех размеров вложенное представление, а также любое пространство, который был определен между каждой вложенное представление.
 - Если `LayoutMarginsRelativeArrangement` свойство `true`, размер стека представления также будет содержать место для поля.
 - Размер перпендикулярно `Axis` будет указано значение наибольшего вложенное представление в коллекции.

Кроме того, можно задать ограничения для представления Stack **высота** и **ширины**. В этом случае вложенные представления будут размещены (размера) для заполнения пространства согласно заданному значению представление стека, что определяется `Distribution` и `Alignment` свойства.

Если `BaselineRelativeArrangement` свойство `true`, вложенные представления будут размещены зависимости от базового плана первой или последней вложенное представление элемента, вместо использования **верхней**, **нижней** или **Center** -  **Y** позиции. Они вычисляются в содержимом представление стека следующим образом:

 - Возвращает вертикальное представление стека первый вложенное представление для базового плана первой и последней последнего. Если любой из этих представлений, сами стек представлений, то будет использоваться первый или последний базовому плану.
 - Горизонтальное представление стека будет использовать его высокого вложенное представление для первого и последнего базового плана. Если высокого представление является также представление стека, он будет использовать его высокого вложенное представление в качестве базовых показателей.

> [!IMPORTANT]
> Выравнивание базового плана работает на вложенное представление растянутым или сжатый размер базового плана вычисляется в неправильное расположение. Выравнивание базового плана, убедитесь, что вложенное представление **высота** соответствие встроенных содержимого представления **высота**.

### <a name="common-stack-view-uses"></a>Наиболее частые способы представление стека

Существует несколько типов макета, которые подходят для элементов управления в представление стека. В соответствии с Apple ниже приведены некоторые из наиболее распространенных.

- **Определить размер вдоль оси** — путем закрепления к обеим границам вдоль представление стека `Axis` и одной из смежных границ, чтобы установить позицию, стек будет увеличиваться представления вдоль оси в соответствии с пространство, определяемое вложенных представлений.
 -  **Определить положение вложенное представление** —, закрепив на смежные края представление стека для его родительского представления, представление стека будет увеличиваться обоим измерениям в соответствии с его содержащего вложенных представлений.
- **Определить размер и положение стека** – закрепление всех четырех краев представление стека родительскому представлению, представление стека упорядочивает вложенных представлений, в зависимости от места, определенные в представление стека.
 -  **Определить размер перпендикулярной осью** — путем закрепления обе границы перпендикулярно представление стека `Axis` и одной из границ вдоль оси, чтобы установить позицию, стека, представление будет увеличиваться перпендикулярно оси в соответствии с пространству, определенному его вложенные представления.

### <a name="managing-the-appearance"></a>Управление внешним видом

`UIStackView` Разработан как представление не визуализируемых контейнера и таким образом, для ее правильной ориентации на холст, как и другие подклассы `UIView`. Установка свойств, таких как `BackgroundColor` или переопределение `DrawRect` не будет действовать visual.

Существует несколько свойств, определяющих, как представление стека всей коллекции вложенных представлений.

- **Оси** — определяет, если представление стека упорядочивает вложенные представления либо **горизонтально** или **вертикально**.
- **Выравнивание** — управляет выравниванием вложенные представления в виде стека.
- **Распределение** — определяет способ изменения размеров вложенные представления в виде стека.
- **Интервал между** — определяет минимальное расстояние между каждой вложенное представление в представление стека.
- **Относительно базовых показателей** — Если `true`, вертикальный интервал каждого вложенное представление будет получен из его базовых показателей.
- **Макет поля относительный** — помещает вложенные представления относительно полей стандартным макетом.

Обычно для размещения небольшого числа вложенных представлений используется представление стека. Более сложные пользовательские интерфейсы, которые могут создаваться путем вложения одно или несколько представлений стек друг в друга (как это было сделано [быстрого запуска UIStackView](#UIStackView-Quickstart) выше).

Дополнительно можно точно настроить внешний пользовательских интерфейсов, добавив дополнительные ограничения вложенные представления (например, элементу управления, высоты или ширины). Однако следует соблюдать осторожность не будет включать конфликтующими ограничениями на появляющиеся, представление стека сам.

### <a name="maintaining-arranged-views-and-sub-views-consistency"></a>Обслуживание упорядоченных представлений и вложенных представлений согласованности

Представление стека убедитесь, что его `ArrangedSubviews` свойства всегда является подмножеством его `Subviews` свойства, используя следующие правила:

 - Если вложенное представление добавляется к `ArrangedSubviews` коллекции, оно будет автоматически добавляться к `Subviews` коллекции (если он уже является частью этой коллекции).
 - Если вложенное представление удаляется из `Subviews` коллекции (удалены из отображения), он также удаляется из `ArrangedSubviews` коллекции.
 - Удаление вложенное представление с `ArrangedSubviews` коллекции не удаляется из `Subviews` коллекции. Так что он больше не будет состоять из представления Stack, но по-прежнему отображаться на экране.

`ArrangedSubviews` Коллекции всегда является подмножеством `Subview` коллекции, однако порядок отдельных вложенных представлений в каждой коллекции является отдельным и управляется следующее:

 - Порядок вложенные представления в `ArrangedSubviews` коллекции определить порядок их отображения в стеке.
 - Порядок вложенные представления в `Subview` коллекции определяет их Z-порядок (или структура), в представлении обратно на передний план.

### <a name="dynamically-changing-content"></a>Динамическое изменение содержимого

Представление стека автоматически настроит макет вложенных представлений, каждый раз, когда вложенное представление добавлены, удалены или скрыт. Макет будет впоследствии также скорректирована если корректируется представление стека любого свойства (такие как его `Axis`).

Изменения макета могут быть анимированы, поместив их внутри блока анимации, например:

```csharp
// Animate stack
UIView.Animate(0.25, ()=>{
    // Adjust stack view
    RatingView.LayoutIfNeeded();
});
```

Многие из свойств этого представления стека можно указать с помощью классов размера в раскадровке. Эти свойства будут автоматически анимации является ответ на изменения размера или ориентации.

## <a name="summary"></a>Сводка

В этой статье подробно рассматривается новый `UIStackView` управления (для iOS 9) для управления набором вложенных представлений в виде упорядочиваются горизонтально или вертикально стека в приложении Xamarin.iOS.
Он начинается с простой пример создания пользовательского интерфейса с помощью представления стека и завершил работу с более подробно изучить стек представлений и их свойства и возможности.



## <a name="related-links"></a>Связанные ссылки

- [Примеры iOS 9](https://developer.xamarin.com/samples/ios/iOS9/)
- [iOS 9 для разработчиков](https://developer.apple.com/ios/pre-release/)
- [Новые возможности в iOS 9.0](https://developer.apple.com/library/prerelease/ios/releasenotes/General/WhatsNewIniOS/Articles/iOS9.html)
- [Справочник по UIStackView](https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UIStackView_Class_Reference/)
- [Знакомство с UIStackView (видео)](https://university.xamarin.com/lightninglectures/introducing-uistackview-on-ios9)
